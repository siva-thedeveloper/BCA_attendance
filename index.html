<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>College Attendance System</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Lucide Icons -->
  <script src="https://unpkg.com/lucide@latest"></script>

  <style>
    body { font-family: ui-sans-serif, system-ui; }
  </style>
</head>
<body class="bg-slate-50 min-h-screen">

<!-- HEADER -->
<header class="bg-white border-b shadow-sm px-6 py-4 flex items-center justify-between">
  <div class="flex items-center gap-3">
    <div class="w-12 h-12 bg-indigo-600 rounded-xl flex items-center justify-center text-white">
      <i data-lucide="school"></i>
    </div>
    <div>
      <h1 class="font-black text-lg uppercase">TIRUKKOILUR COLLEGE OF ARTS AND SCIENCE</h1>
      <p class="text-xs font-bold text-indigo-600">Department of Computer Applications (BCA)</p>
    </div>
  </div>
</header>

<!-- LOGIN PAGE -->
<div id="loginPage" class="flex items-center justify-center p-6">
  <div class="bg-white rounded-3xl shadow-xl w-full max-w-md p-8 space-y-6">
    <h2 class="text-2xl font-black text-center">Login</h2>

    <input id="loginUser" class="w-full p-4 border rounded-xl font-bold" placeholder="Username">
    <input id="loginPass" type="password" class="w-full p-4 border rounded-xl font-bold" placeholder="Password">

    <p id="loginError" class="text-red-500 font-bold hidden"></p>

    <div class="grid grid-cols-2 gap-4">
      <button onclick="login('staff')" class="bg-indigo-600 text-white font-black py-3 rounded-xl">STAFF</button>
      <button onclick="login('admin')" class="bg-slate-900 text-white font-black py-3 rounded-xl">ADMIN</button>
    </div>
  </div>
</div>

<!-- ADMIN PAGE -->
<div id="adminPage" class="hidden p-6 max-w-5xl mx-auto">
  <div class="flex justify-between mb-6">
    <h2 class="text-2xl font-black">Admin Dashboard</h2>
    <button onclick="logout()" class="text-red-600 font-bold">Logout</button>
  </div>

  <div class="bg-white rounded-2xl p-6 shadow">
    <h3 class="font-black mb-4">Add Staff</h3>
    <div class="grid md:grid-cols-3 gap-4">
      <input id="staffName" class="p-3 border rounded-xl" placeholder="Name">
      <input id="staffUser" class="p-3 border rounded-xl" placeholder="Username">
      <input id="staffPass" class="p-3 border rounded-xl" placeholder="Password">
    </div>
    <button onclick="addStaff()" class="mt-4 bg-indigo-600 text-white px-6 py-3 rounded-xl font-black">ADD STAFF</button>
  </div>

  <div class="mt-8 bg-white rounded-2xl shadow overflow-hidden">
    <table class="w-full">
      <thead class="bg-slate-100 text-left">
        <tr>
          <th class="p-4">Name</th>
          <th class="p-4">Username</th>
          <th class="p-4">Action</th>
        </tr>
      </thead>
      <tbody id="staffTable"></tbody>
    </table>
  </div>
</div>

<!-- STAFF PAGE -->
<div id="staffPage" class="hidden p-6 max-w-5xl mx-auto">
  <div class="flex justify-between mb-6">
    <h2 class="text-2xl font-black">Attendance</h2>
    <button onclick="logout()" class="text-red-600 font-bold">Logout</button>
  </div>

  <div class="bg-white rounded-2xl shadow p-6">
    <table class="w-full">
      <thead class="bg-slate-100">
        <tr>
          <th class="p-4">Roll No</th>
          <th class="p-4">Name</th>
          <th class="p-4">Status</th>
        </tr>
      </thead>
      <tbody id="attendanceTable"></tbody>
    </table>
  </div>
</div>

<script>
/* ---------- DATA ---------- */
const config = {
  adminUser: "admin",
  adminPass: "admin123"
};

let staffList = JSON.parse(localStorage.getItem("staffList")) || [];
let students = [
  { roll: "24BCAA01", name: "Aravind K" },
  { roll: "24BCAA02", name: "Baskar M" },
  { roll: "24BCAA03", name: "Deepa R" }
];
let attendance = JSON.parse(localStorage.getItem("attendance")) || {};

/* ---------- LOGIN ---------- */
function login(role) {
  const u = loginUser.value;
  const p = loginPass.value;

  if (role === "admin") {
    if (u === config.adminUser && p === config.adminPass) {
      show("adminPage");
      loadStaff();
    } else error();
  } else {
    if (staffList.find(s => s.user === u && s.pass === p)) {
      show("staffPage");
      loadAttendance();
    } else error();
  }
}

function error() {
  loginError.classList.remove("hidden");
  loginError.innerText = "Invalid credentials";
}

function logout() {
  show("loginPage");
}

/* ---------- STAFF ---------- */
function addStaff() {
  staffList.push({
    name: staffName.value,
    user: staffUser.value,
    pass: staffPass.value
  });
  localStorage.setItem("staffList", JSON.stringify(staffList));
  loadStaff();
}

function loadStaff() {
  staffTable.innerHTML = "";
  staffList.forEach((s, i) => {
    staffTable.innerHTML += `
      <tr>
        <td class="p-4">${s.name}</td>
        <td class="p-4">${s.user}</td>
        <td class="p-4">
          <button onclick="removeStaff(${i})" class="text-red-600">Delete</button>
        </td>
      </tr>`;
  });
}

function removeStaff(i) {
  staffList.splice(i, 1);
  localStorage.setItem("staffList", JSON.stringify(staffList));
  loadStaff();
}

/* ---------- ATTENDANCE ---------- */
function loadAttendance() {
  attendanceTable.innerHTML = "";
  students.forEach(s => {
    attendanceTable.innerHTML += `
      <tr>
        <td class="p-4">${s.roll}</td>
        <td class="p-4">${s.name}</td>
        <td class="p-4">
          <select onchange="mark('${s.roll}', this.value)" class="border p-2 rounded">
            <option value="">--</option>
            <option value="P">Present</option>
            <option value="A">Absent</option>
          </select>
        </td>
      </tr>`;
  });
}

function mark(roll, val) {
  attendance[roll] = val;
  localStorage.setItem("attendance", JSON.stringify(attendance));
}

/* ---------- UI ---------- */
function show(id) {
  ["loginPage","adminPage","staffPage"].forEach(p =>
    document.getElementById(p).classList.add("hidden")
  );
  document.getElementById(id).classList.remove("hidden");
}

lucide.createIcons();
</script>

</body>
</html>
